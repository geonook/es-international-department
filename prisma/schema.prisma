// KCISLK ESID Info Hub Prisma Schema
// 支援 Zeabur 多環境雲端資料庫部署
// Supports Zeabur multi-environment cloud database deployment

generator client {
  provider = "prisma-client-js"
  // 優化客戶端生成以支援 Zeabur 部署環境
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  // PostgreSQL 原生支援外鍵約束，無需額外配置
}

// 使用者管理 | User Management
model User {
  id            String    @id @default(cuid())
  email         String    @unique
  passwordHash  String?   @map("password_hash")
  firstName     String?   @map("first_name") @db.VarChar(100)
  lastName      String?   @map("last_name") @db.VarChar(100)
  displayName   String?   @map("display_name") @db.VarChar(200)
  phone         String?   @db.VarChar(20)
  avatarUrl     String?   @map("avatar_url")
  isActive      Boolean   @default(true) @map("is_active")
  emailVerified Boolean   @default(false) @map("email_verified")
  lastLoginAt   DateTime? @map("last_login_at")
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")

  // OAuth 支援欄位
  googleId      String?   @unique @map("google_id")
  provider      String?   @default("email") @map("provider") @db.VarChar(20) // "email" | "google" | "mixed"
  providerAccountId String? @map("provider_account_id")

  // Relations
  userRoles       UserRole[] @relation("UserRoles")
  assignedRoles   UserRole[] @relation("UserRoleAssigner")
  sessions        UserSession[]
  accounts        Account[] // OAuth 帳戶連結
  announcements   Announcement[]
  newsletters     Newsletter[]
  events          Event[]
  resources       Resource[]
  notifications   Notification[]
  messageBoard    MessageBoard[]
  messageReplies  MessageReply[]
  feedbackForms   FeedbackForm[] @relation("FeedbackAuthor")
  assignedFeedback FeedbackForm[] @relation("FeedbackAssigned")
  fileUploads     FileUpload[]
  settingsUpdated SystemSetting[]
  eventRegistrations EventRegistration[] @relation("UserEventRegistrations")
  eventNotifications EventNotification[] @relation("EventNotificationCreator")
  notificationPreferences NotificationPreference?
  gradeAssignments UserGradeAssignment[]
  permissionUpgradeRequests PermissionUpgradeRequest[] @relation("PermissionUpgradeUser")
  permissionUpgradeRequestsCreated PermissionUpgradeRequest[] @relation("PermissionUpgradeRequestedBy")
  permissionUpgradeRequestsReviewed PermissionUpgradeRequest[] @relation("PermissionUpgradeReviewedBy")
  resourceVersions ResourceVersion[]
  resourceEditHistory ResourceEditHistory[]
  teacherRemindersCreated TeacherReminder[] @relation("TeacherReminderCreator")
  teacherRemindersCompleted TeacherReminder[] @relation("TeacherReminderCompleter")

  @@map("users")
}

model Role {
  id          Int      @id @default(autoincrement())
  name        String   @unique @db.VarChar(50)
  displayName String   @map("display_name") @db.VarChar(100)
  description String?
  permissions Json?
  createdAt   DateTime @default(now()) @map("created_at")

  // Relations
  userRoles UserRole[]

  @@map("roles")
}

model UserRole {
  id         Int      @id @default(autoincrement())
  userId     String   @map("user_id")
  roleId     Int      @map("role_id")
  assignedBy String?  @map("assigned_by")
  assignedAt DateTime @default(now()) @map("assigned_at")

  // Relations
  user     User  @relation("UserRoles", fields: [userId], references: [id], onDelete: Cascade)
  role     Role  @relation(fields: [roleId], references: [id], onDelete: Cascade)
  assigner User? @relation("UserRoleAssigner", fields: [assignedBy], references: [id])

  @@unique([userId, roleId])
  @@map("user_roles")
}

// 權限升級請求 | Permission Upgrade Request
model PermissionUpgradeRequest {
  id              String    @id @default(cuid())
  userId          String    @map("user_id")
  requestedRole   String    @map("requested_role") @db.VarChar(50)
  reason          String
  status          String    @default("pending") @db.VarChar(20) // 'pending', 'approved', 'rejected'
  requestedBy     String    @map("requested_by")
  reviewedBy      String?   @map("reviewed_by")
  reviewNotes     String?   @map("review_notes")
  submittedAt     DateTime  @default(now()) @map("submitted_at")
  reviewedAt      DateTime? @map("reviewed_at")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  // Relations
  user              User  @relation("PermissionUpgradeUser", fields: [userId], references: [id], onDelete: Cascade)
  requestedByUser   User  @relation("PermissionUpgradeRequestedBy", fields: [requestedBy], references: [id])
  reviewedByUser    User? @relation("PermissionUpgradeReviewedBy", fields: [reviewedBy], references: [id])

  @@map("permission_upgrade_requests")
}

// OAuth 帳戶管理 | OAuth Account Management
model Account {
  id                String  @id @default(cuid())
  userId            String  @map("user_id")
  type              String  @db.VarChar(50)
  provider          String  @db.VarChar(50)
  providerAccountId String  @map("provider_account_id") @db.VarChar(255)
  refresh_token     String? @db.Text
  access_token      String? @db.Text
  expires_at        Int?
  token_type        String? @db.VarChar(50)
  scope             String? @db.VarChar(255)
  id_token          String? @db.Text
  session_state     String? @db.VarChar(255)
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")
  
  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([provider, providerAccountId])
  @@map("accounts")
}

model UserSession {
  id           String    @id @default(cuid())
  userId       String    @map("user_id")
  sessionToken String    @unique @map("session_token")
  expiresAt    DateTime  @map("expires_at")
  ipAddress    String?   @map("ip_address")
  userAgent    String?   @map("user_agent")
  createdAt    DateTime  @default(now()) @map("created_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_sessions")
}

// 內容管理 | Content Management
model Announcement {
  id             Int       @id @default(autoincrement())
  title          String    @db.VarChar(255)
  content        String
  summary        String?
  authorId       String?   @map("author_id")
  targetAudience String    @map("target_audience") @db.VarChar(20) // 'teachers', 'parents', 'all'
  priority       String    @default("medium") @db.VarChar(10) // 'low', 'medium', 'high', 'urgent'
  status         String    @default("draft") @db.VarChar(20) // 'draft', 'published', 'archived'
  publishedAt    DateTime? @map("published_at")
  expiresAt      DateTime? @map("expires_at")
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")

  // Relations
  author User? @relation(fields: [authorId], references: [id])

  @@map("announcements")
}

model Newsletter {
  id              Int       @id @default(autoincrement())
  title           String    @db.VarChar(255)
  content         String
  htmlContent     String?   @map("html_content")
  coverImageUrl   String?   @map("cover_image_url")
  authorId        String?   @map("author_id")
  status          String    @default("draft") @db.VarChar(20) // 'draft', 'published', 'archived'
  issueNumber     Int?      @map("issue_number")
  publicationDate DateTime? @map("publication_date") @db.Date
  downloadCount   Int       @default(0) @map("download_count")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  // Relations
  author User? @relation(fields: [authorId], references: [id])

  @@map("newsletters")
}

model Event {
  id                    Int       @id @default(autoincrement())
  title                 String    @db.VarChar(255)
  description           String?
  eventType             String    @map("event_type") @db.VarChar(50)
  startDate             DateTime  @map("start_date") @db.Date
  endDate               DateTime? @map("end_date") @db.Date
  startTime             DateTime? @map("start_time") @db.Time
  endTime               DateTime? @map("end_time") @db.Time
  location              String?   @db.VarChar(255)
  maxParticipants       Int?      @map("max_participants")
  registrationRequired  Boolean   @default(false) @map("registration_required")
  registrationDeadline  DateTime? @map("registration_deadline") @db.Date
  targetGrades          Json?     @map("target_grades") // Array of grade levels
  createdBy             String?   @map("created_by")
  isFeatured            Boolean   @default(false) @map("is_featured")
  status                String    @default("draft") @db.VarChar(20) // 'draft', 'published', 'cancelled'
  createdAt             DateTime  @default(now()) @map("created_at")
  updatedAt             DateTime  @updatedAt @map("updated_at")

  // Relations
  creator User? @relation(fields: [createdBy], references: [id])
  registrations EventRegistration[]
  notifications EventNotification[]
  attachments   FileUpload[] @relation("EventAttachments")

  @@map("events")
}

// 活動報名管理 | Event Registration Management
model EventRegistration {
  id                Int       @id @default(autoincrement())
  eventId           Int       @map("event_id")
  userId            String    @map("user_id")
  participantName   String?   @map("participant_name") @db.VarChar(100) // For family members
  participantEmail  String?   @map("participant_email") @db.VarChar(255)
  participantPhone  String?   @map("participant_phone") @db.VarChar(20)
  grade             String?   @db.VarChar(20) // For student events
  specialRequests   String?   @map("special_requests")
  status            String    @default("confirmed") @db.VarChar(20) // 'confirmed', 'waiting_list', 'cancelled'
  registeredAt      DateTime  @default(now()) @map("registered_at")
  checkedIn         Boolean   @default(false) @map("checked_in")
  checkedInAt       DateTime? @map("checked_in_at")
  attendanceNotes   String?   @map("attendance_notes")
  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime  @updatedAt @map("updated_at")

  // Relations
  event Event @relation(fields: [eventId], references: [id], onDelete: Cascade)
  user  User  @relation("UserEventRegistrations", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([eventId, userId])
  @@index([eventId, status])
  @@index([userId, status])
  @@map("event_registrations")
}

// 活動通知管理 | Event Notification Management
model EventNotification {
  id              Int       @id @default(autoincrement())
  eventId         Int       @map("event_id")
  type            String    @db.VarChar(50) // 'reminder', 'update', 'cancellation', 'registration_confirmed'
  recipientType   String    @map("recipient_type") @db.VarChar(20) // 'all_registered', 'specific_users', 'target_audience'
  title           String    @db.VarChar(255)
  message         String
  scheduledFor    DateTime? @map("scheduled_for") // For scheduled notifications
  sentAt          DateTime? @map("sent_at")
  status          String    @default("pending") @db.VarChar(20) // 'pending', 'sent', 'failed', 'cancelled'
  recipientCount  Int       @default(0) @map("recipient_count")
  deliveredCount  Int       @default(0) @map("delivered_count")
  errorMessage    String?   @map("error_message")
  createdBy       String?   @map("created_by")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  // Relations
  event   Event @relation(fields: [eventId], references: [id], onDelete: Cascade)
  creator User? @relation("EventNotificationCreator", fields: [createdBy], references: [id])

  @@index([eventId, type])
  @@index([status, scheduledFor])
  @@map("event_notifications")
}

model CoffeeWithPrincipal {
  id                Int      @id @default(autoincrement())
  title             String   @db.VarChar(255)
  description       String?
  gradeLevels       Json     @map("grade_levels") // ['1-2', '3-4', '5-6']
  presentationUrl   String?  @map("presentation_url")
  materialsUrl      String?  @map("materials_url")
  eventDate         DateTime @map("event_date") @db.Date
  sessionTime       DateTime? @map("session_time") @db.Time
  location          String?  @db.VarChar(255)
  maxParticipants   Int?     @map("max_participants")
  registrationCount Int      @default(0) @map("registration_count")
  status            String   @default("upcoming") @db.VarChar(20) // 'upcoming', 'ongoing', 'completed', 'cancelled'
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")

  @@map("coffee_with_principal")
}

// 資源管理 | Resource Management
model ResourceCategory {
  id          Int      @id @default(autoincrement())
  name        String   @unique @db.VarChar(100)
  displayName String   @map("display_name") @db.VarChar(200)
  description String?
  icon        String?  @db.VarChar(50)
  color       String?  @db.VarChar(50)
  sortOrder   Int      @default(0) @map("sort_order")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")

  // Relations
  resources Resource[]

  @@map("resource_categories")
}

model GradeLevel {
  id          Int      @id @default(autoincrement())
  name        String   @unique @db.VarChar(20) // 'Grades 1-2', 'Grades 3-4', etc.
  displayName String   @map("display_name") @db.VarChar(50)
  minGrade    Int      @map("min_grade")
  maxGrade    Int      @map("max_grade")
  color       String?  @db.VarChar(50)
  sortOrder   Int      @default(0) @map("sort_order")
  isActive    Boolean  @default(true) @map("is_active")

  // Relations
  resources Resource[]
  userAssignments UserGradeAssignment[]

  @@map("grade_levels")
}

model Resource {
  id            Int       @id @default(autoincrement())
  title         String    @db.VarChar(255)
  description   String?
  resourceType  String    @map("resource_type") @db.VarChar(50) // 'PDF', 'Video', 'Interactive', 'External Platform'
  fileUrl       String?   @map("file_url")
  externalUrl   String?   @map("external_url")
  thumbnailUrl  String?   @map("thumbnail_url")
  fileSize      BigInt?   @map("file_size") // in bytes
  duration      Int?      // for video resources in seconds
  gradeLevelId  Int?      @map("grade_level_id")
  categoryId    Int?      @map("category_id")
  createdBy     String?   @map("created_by")
  downloadCount Int       @default(0) @map("download_count")
  viewCount     Int       @default(0) @map("view_count")
  isFeatured    Boolean   @default(false) @map("is_featured")
  status        String    @default("draft") @db.VarChar(20) // 'draft', 'published', 'archived'
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")

  // Relations
  gradeLevel GradeLevel? @relation(fields: [gradeLevelId], references: [id])
  category   ResourceCategory? @relation(fields: [categoryId], references: [id])
  creator    User? @relation(fields: [createdBy], references: [id])
  tags       ResourceTagRelation[]
  versions   ResourceVersion[]
  editHistory ResourceEditHistory[]

  @@map("resources")
}

model ResourceTag {
  id        Int      @id @default(autoincrement())
  name      String   @unique @db.VarChar(50)
  color     String?  @db.VarChar(20)
  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  resources ResourceTagRelation[]

  @@map("resource_tags")
}

model ResourceTagRelation {
  resourceId Int @map("resource_id")
  tagId      Int @map("tag_id")

  // Relations
  resource Resource    @relation(fields: [resourceId], references: [id], onDelete: Cascade)
  tag      ResourceTag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([resourceId, tagId])
  @@map("resource_tag_relations")
}

// 資源版本控制 | Resource Version Control
model ResourceVersion {
  id          Int      @id @default(autoincrement())
  resourceId  Int      @map("resource_id")
  version     String   @db.VarChar(20) // v1.0, v1.1, etc.
  title       String   @db.VarChar(255)
  description String?
  fileUrl     String?  @map("file_url")
  externalUrl String?  @map("external_url")
  fileSize    BigInt?  @map("file_size")
  changeLog   String?  @map("change_log") // 版本變更記錄
  createdBy   String   @map("created_by")
  createdAt   DateTime @default(now()) @map("created_at")
  isActive    Boolean  @default(false) @map("is_active") // 當前啟用版本

  // Relations
  resource Resource @relation(fields: [resourceId], references: [id], onDelete: Cascade)
  creator  User     @relation(fields: [createdBy], references: [id])

  @@unique([resourceId, version])
  @@map("resource_versions")
}

// 資源編輯歷史 | Resource Edit History
model ResourceEditHistory {
  id          Int      @id @default(autoincrement())
  resourceId  Int      @map("resource_id")
  action      String   @db.VarChar(50) // create, update, publish, archive, restore
  fieldName   String?  @map("field_name") @db.VarChar(100) // 異動的欄位名稱
  oldValue    String?  @map("old_value") // 舊值
  newValue    String?  @map("new_value") // 新值
  description String?  // 編輯描述
  editedBy    String   @map("edited_by")
  editedAt    DateTime @default(now()) @map("edited_at")

  // Relations
  resource Resource @relation(fields: [resourceId], references: [id], onDelete: Cascade)
  editor   User     @relation(fields: [editedBy], references: [id])

  @@index([resourceId, editedAt])
  @@map("resource_edit_history")
}

// 通知與溝通 | Notification & Communication
model Notification {
  id          Int       @id @default(autoincrement())
  recipientId String    @map("recipient_id")
  title       String    @db.VarChar(255)
  message     String
  type        String    @db.VarChar(50) // 'announcement', 'event', 'newsletter', 'system'
  relatedId   Int?      @map("related_id") // Reference to related entity
  relatedType String?   @map("related_type") @db.VarChar(50) // Type of related entity
  isRead      Boolean   @default(false) @map("is_read")
  readAt      DateTime? @map("read_at")
  priority    String    @default("medium") @db.VarChar(10) // 'low', 'medium', 'high'
  expiresAt   DateTime? @map("expires_at")
  createdAt   DateTime  @default(now()) @map("created_at")

  // Relations
  recipient User @relation(fields: [recipientId], references: [id], onDelete: Cascade)

  @@map("notifications")
}

model MessageBoard {
  id         Int      @id @default(autoincrement())
  title      String   @db.VarChar(255)
  content    String
  authorId   String?  @map("author_id")
  boardType  String   @default("general") @db.VarChar(20) // 'teachers', 'parents', 'general'
  isPinned   Boolean  @default(false) @map("is_pinned")
  replyCount Int      @default(0) @map("reply_count")
  viewCount  Int      @default(0) @map("view_count")
  status     String   @default("active") @db.VarChar(20) // 'active', 'closed', 'archived'
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")

  // Relations
  author  User? @relation(fields: [authorId], references: [id])
  replies MessageReply[]

  @@map("message_board")
}

model MessageReply {
  id            Int       @id @default(autoincrement())
  messageId     Int       @map("message_id")
  authorId      String?   @map("author_id")
  content       String
  parentReplyId Int?      @map("parent_reply_id") // For nested replies
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")

  // Relations
  message     MessageBoard  @relation(fields: [messageId], references: [id], onDelete: Cascade)
  author      User?         @relation(fields: [authorId], references: [id])
  parentReply MessageReply? @relation("ReplyToReply", fields: [parentReplyId], references: [id])
  childReplies MessageReply[] @relation("ReplyToReply")

  @@map("message_replies")
}

model FeedbackForm {
  id           Int       @id @default(autoincrement())
  authorId     String?   @map("author_id")
  authorName   String?   @map("author_name") @db.VarChar(100) // For anonymous feedback
  authorEmail  String?   @map("author_email") @db.VarChar(255) // For anonymous feedback
  subject      String    @db.VarChar(255)
  message      String
  category     String?   @db.VarChar(50) // 'suggestion', 'complaint', 'appreciation', 'question'
  priority     String    @default("medium") @db.VarChar(10) // 'low', 'medium', 'high'
  status       String    @default("new") @db.VarChar(20) // 'new', 'in_progress', 'resolved', 'closed'
  assignedTo   String?   @map("assigned_to")
  response     String?
  responseDate DateTime? @map("response_date")
  isAnonymous  Boolean   @default(false) @map("is_anonymous")
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime  @updatedAt @map("updated_at")

  // Relations
  author   User? @relation("FeedbackAuthor", fields: [authorId], references: [id])
  assignee User? @relation("FeedbackAssigned", fields: [assignedTo], references: [id])

  @@map("feedback_forms")
}

// 系統設定 | System Configuration
model SystemSetting {
  id          Int      @id @default(autoincrement())
  key         String   @unique @db.VarChar(100)
  value       String?
  description String?
  dataType    String   @default("string") @db.VarChar(20) // 'string', 'number', 'boolean', 'json'
  isPublic    Boolean  @default(false) @map("is_public") // Whether this setting can be accessed by non-admins
  updatedBy   String?  @map("updated_by")
  updatedAt   DateTime @updatedAt @map("updated_at")

  // Relations
  updater User? @relation(fields: [updatedBy], references: [id])

  @@map("system_settings")
}

model FileUpload {
  id               Int      @id @default(autoincrement())
  originalFilename String   @map("original_filename") @db.VarChar(255)
  storedFilename   String   @map("stored_filename") @db.VarChar(255)
  filePath         String   @map("file_path")
  fileSize         BigInt   @map("file_size")
  mimeType         String?  @map("mime_type") @db.VarChar(100)
  uploadedBy       String?  @map("uploaded_by")
  relatedType      String?  @map("related_type") @db.VarChar(50) // 'announcement', 'newsletter', 'resource', 'event', etc.
  relatedId        Int?     @map("related_id")
  eventAttachment  Event?   @relation("EventAttachments", fields: [relatedId], references: [id])
  createdAt        DateTime @default(now()) @map("created_at")

  // Relations
  uploader User? @relation(fields: [uploadedBy], references: [id])

  @@map("file_uploads")
}

// 用戶通知偏好設定 | User Notification Preferences
model NotificationPreference {
  id          Int      @id @default(autoincrement())
  userId      String   @unique @map("user_id")
  email       Boolean  @default(true)
  system      Boolean  @default(true)
  browser     Boolean  @default(true)
  
  // 免打擾時段
  doNotDisturbEnabled Boolean  @default(false) @map("do_not_disturb_enabled")
  doNotDisturbStart   String?  @map("do_not_disturb_start") @db.VarChar(5) // "22:00" format
  doNotDisturbEnd     String?  @map("do_not_disturb_end") @db.VarChar(5)   // "08:00" format
  
  // 分類偏好 (JSON 格式存儲)
  categoryPreferences Json     @default("{}") @map("category_preferences")
  
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  
  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("notification_preferences")
}

// 用戶年級關聯 | User Grade Assignment
model UserGradeAssignment {
  id          Int      @id @default(autoincrement())
  userId      String   @map("user_id")
  gradeLevelId Int     @map("grade_level_id")
  relationship String  @db.VarChar(20) // 'parent', 'teacher', 'student'
  isActive    Boolean  @default(true) @map("is_active")
  assignedAt  DateTime @default(now()) @map("assigned_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  
  // Relations
  user       User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  gradeLevel GradeLevel @relation(fields: [gradeLevelId], references: [id], onDelete: Cascade)
  
  @@unique([userId, gradeLevelId, relationship])
  @@index([userId, isActive])
  @@index([gradeLevelId, relationship, isActive])
  @@map("user_grade_assignments")
}

// 教師提醒系統 | Teacher Reminders System
model TeacherReminder {
  id          Int      @id @default(autoincrement())
  title       String   @db.VarChar(255)
  content     String
  priority    String   @default("medium") @db.VarChar(10) // 'low', 'medium', 'high', 'urgent'
  status      String   @default("active") @db.VarChar(20) // 'active', 'completed', 'cancelled', 'pending'
  dueDate     DateTime? @map("due_date") @db.Date
  dueTime     DateTime? @map("due_time") @db.Time
  createdBy   String?  @map("created_by")
  targetAudience String @default("all") @map("target_audience") @db.VarChar(20) // 'all', 'specific_grades', 'departments'
  reminderType String  @default("general") @map("reminder_type") @db.VarChar(50) // 'deadline', 'meeting', 'task', 'announcement', 'general'
  isRecurring Boolean  @default(false) @map("is_recurring")
  recurringPattern String? @map("recurring_pattern") @db.VarChar(50) // 'daily', 'weekly', 'monthly', 'custom'
  completedAt DateTime? @map("completed_at")
  completedBy String?  @map("completed_by")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  // Relations
  creator     User? @relation("TeacherReminderCreator", fields: [createdBy], references: [id])
  completer   User? @relation("TeacherReminderCompleter", fields: [completedBy], references: [id])

  @@index([status, dueDate])
  @@index([createdBy, status])
  @@index([priority, dueDate])
  @@map("teacher_reminders")
}